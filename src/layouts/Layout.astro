---
import '../styles/global.css';

import favIcon from '../assets/favicon.png';

// Importing google fonts
import GoogleFonts from '@/components/extras/GoogleFonts.astro';

// Importing google tag manager
import GoogleTag from '@/components/extras/GoogleTag.astro';

// Importing the SEO and GTM component
import Seo from '../components/seo/Seo.astro';
import GtmPush from '@/components/extras/GtmPush.astro';

// Importing the default SEO and location schema
import { defaultSeo } from '../data/js/seo/index.js';
import { locationSchema } from '../data/js/seo/locationSchema.js';

import Header from '../components/header/Header.astro';
import Footer from '../components/footer/Footer.astro';

const { seo = defaultSeo, location = locationSchema, gtm = null } = Astro.props;

const gtmProps = gtm
  ? {
      event: gtm.eventAction,
      eventCategory: gtm.eventCategory,
      eventLabel: gtm.eventLabel,
      serviceTier: gtm.dataLayerPush?.reportType?.join(', ') ?? '',
      regulatoryLevel: Array.isArray(gtm.dataLayerPush?.certification)
        ? gtm.dataLayerPush.certification.join(', ')
        : (gtm.dataLayerPush?.certification ?? ''),
    }
  : null;

// console.log('ðŸš€ ~ gtmProps:', gtmProps);
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/png+xml" href={favIcon.src} />

    {/* Google Fonts */}
    <GoogleFonts />

    {/* SEO component */}
    <Seo {...seo} locationSchema={location} />

    {/* Google Tag Manager */}
    <GoogleTag />

    {/* GTM  */}
    {gtmProps && <GtmPush {...gtmProps} />}
  </head>
  <Header />
  <slot />
  <Footer />
</html>
